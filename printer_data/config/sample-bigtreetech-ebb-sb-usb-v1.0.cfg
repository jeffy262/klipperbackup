# ---- EBB USB toolhead board ----
[mcu EBB]
serial: /dev/serial/by-id/usb-Klipper_rp2040_50443403106AD11C-if00
restart_method: command

# ---------------- Thermistor on EBB ----------------
# Choose ONE of the following hotend sensor configs:

# --- Option A: Rapido 2 UHF with PT1000 (common) ---
#[temperature_sensor EBB_HOTEND]           # (If you prefer [temperature_sensor] style)
#sensor_type: PT1000
#sensor_pin: EBB:gpio26
#pullup_resistor: 2200                     # EBB USB uses 2.2k

# Or as the extruder's sensor (recommended):
# (See [extruder] block below; set sensor_type: PT1000 there)

# --- Option B: Rapido with 104NT (Semitec) ---
#[temperature_sensor EBB_HOTEND]
#sensor_type: ATC Semitec 104NT-4-R025H42G
#sensor_pin: EBB:gpio26
#pullup_resistor: 2200

# If you also have a board NTC on the EBB:
[temperature_sensor EBB_NTC]
sensor_type: Generic 3950
sensor_pin: EBB:gpio27
min_temp: 0
max_temp: 120

# ---------------- Extruder (Galileo 2) ----------------
[extruder]
step_pin: EBB:gpio18
dir_pin: EBB:gpio19
enable_pin: !EBB:gpio17

microsteps: 16
# Galileo 2 recommended starting values:
rotation_distance: 47.088        # start here, then calibrate by 100 mm test
gear_ratio: 9:1

nozzle_diameter: 1.00            # <-- set to your actual nozzle (e.g., 0.60 or 1.00)
filament_diameter: 1.75

heater_pin: EBB:gpio7
sensor_pin: EBB:gpio26
pullup_resistor: 2200

# --- Pick ONE sensor_type that matches your Rapido 2 cartridge ---
#sensor_type: PT1000
sensor_type: ATC Semitec 104NT-4-R025H42G

# PID values—keep yours or tune at your print temp:
control: pid
pid_Kp: 31.394
pid_Ki: 3.431
pid_Kd: 71.813

min_temp: 10
max_temp: 290
min_extrude_temp: 170            # safety; raise for ABS/PA/etc.

# Safety: limit volumetric mistakes (mm^2 = line_width * layer_height).
# For big UHF lines, set appropriately. Example: 1.0 mm width * 0.4 mm layer ≈ 0.40 mm^2.
# Give margin (× ~2): set ~0.8. Adjust to your max intended line.
max_extrude_cross_section: 0.80

max_extrude_only_distance: 120

[tmc2209 extruder]
uart_pin: EBB:gpio20
run_current: 0.60                 # G2 docs ~0.6 A; adjust if motor skips or runs hot
stealthchop_threshold: 999999

# Part cooling fan
[fan]
pin: EBB:gpio4

# Hotend fan (auto)
[heater_fan hotend_fan]
pin: EBB:gpio14
max_power: 1.0
kick_start_time: 0.5
heater: extruder
heater_temp: 30

[duplicate_pin_override] 
pins: EBB:gpio27


